import e,{useEffect as t,useMemo as a,useState as o}from"react";import r from"./image.skeleton";import s from"../use-real-shape";import i from"../use-current-state";import m from"../use-resize";import{useDOMRef as c}from"../utils/dom";import{__DEV__ as n}from"../utils/assertion";import{StyledImage as u,StyledImageContainer as l}from"./image.styles";import p from"../utils/clsx";import{jsx as f}from"react/jsx-runtime";import{jsxs as d}from"react/jsx-runtime";export const Image=e.forwardRef(((e,n)=>{const{src:g,width:h,height:x,showSkeleton:w,className:y,maxDelay:j,autoResize:I,objectFit:N,containerCss:b,css:k,...z}=e,F=c(n),[R,S]=o(!0),[T,$]=o(w),{w:D,h:C}=a((()=>({w:h?"number"==typeof h?`${h}px`:h:"auto",h:x?"number"==typeof x?`${x}px`:x:"auto"})),[h,x]),[L,P,U]=i(C),[q,v]=s(F),A=w&&!!h&&!!x;t((()=>{F.current&&F.current.complete&&(S(!1),$(!1))})),t((()=>{const e=setTimeout((()=>{A&&$(!1),clearTimeout(e)}),j);return()=>clearTimeout(e)}),[R]),t((()=>{if(!I)return;const e=0===q.width,t="auto"===U.current;!e&&h&&x&&(q.width<h?!t&&P("auto"):t&&P(C))}),[q,h]),m((()=>{I&&v()}));const B=a((()=>R?"loading":"ready"),[R]);return d(l,{className:p("nextui-image-container",`nextui-image--${B}`,y),"data-state":B,ready:!R||T,css:{width:D,height:L,...b},children:[T&&f(r,{opacity:1}),f(u,{ref:F,className:"nextui-image",width:h,height:x,onLoad:()=>{S(!1)},src:g,"data-state":B,alt:e.alt||"",css:{objectFit:N,...k},...z})]})}));n&&(Image.displayName="NextUI.Image"),Image.toString=()=>".nextui-image",Image.defaultProps={showSkeleton:!0,autoResize:!1,objectFit:"scale-down",maxDelay:3e3,className:""};export default e.memo(Image);