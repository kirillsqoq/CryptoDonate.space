import{useRef as e,useMemo as s,useState as o,useCallback as r}from"react";import{useOverlayPosition as t,useOverlayTrigger as i}from"@react-aria/overlays";import{useOverlayTriggerState as l}from"@react-stately/overlays";import{mergeRefs as n}from"../utils/refs";import{getAriaPlacement as a}from"./utils";export function usePopover(p={}){const{isOpen:d,defaultOpen:m,onOpenChange:u,shouldFlip:O=!0,offset:f=12,placement:g="bottom",onClose:c,triggerType:y="dialog",isDismissable:P=!0,shouldCloseOnBlur:b=!1,isKeyboardDismissDisabled:v=!1,disableAnimation:h=!1,shouldCloseOnInteractOutside:C}=p,D=e(null),R=e(null),x=l({isOpen:d,defaultOpen:m,onOpenChange:u}),[A,B]=o(!x.isOpen),E=s((()=>x.isOpen?"open":"closed"),[x.isOpen]),F=r((()=>{null==c||c(),x.close()}),[x,c]),I=r((()=>{B(!1)}),[]),K=r((()=>{B(!0)}),[]),{triggerProps:T,overlayProps:j}=i({type:y},x,D),k=s((()=>a(g)),[g]),{overlayProps:q}=t({isOpen:x.isOpen,targetRef:D,placement:k,overlayRef:R,shouldFlip:O,offset:f}),w=r(((e={},s=null)=>({...e,...T,ref:n(D,s)})),[D,T]),z=r(((e={})=>({...e,...j,...q,"data-state":E,"data-placement":g})),[E,q,j,g]);return{state:x,exited:A,overlayRef:R,triggerRef:D,placement:g,disableAnimation:h,shouldCloseOnBlur:b,isDismissable:P,isKeyboardDismissDisabled:v,shouldCloseOnInteractOutside:C,isOpen:x.isOpen,onClose:F,onExited:K,onEntered:I,triggerProps:T,overlayProps:j,positionProps:q,getTriggerProps:w,getPopoverProps:z}}