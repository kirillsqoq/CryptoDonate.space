System.register(["valtio/vanilla","proxy-compare"],function(C){"use strict";var O,p,v,j,M,D,k;return{setters:[function(y){O=y.subscribe,p=y.snapshot,v=y.proxy,j=y.getVersion,M=y.ref},function(y){D=y.createProxy,k=y.isChanged}],execute:function(){C({addComputed:L,derive:W,devtools:H,proxyMap:X,proxySet:K,proxyWithComputed:U,proxyWithHistory:V,subscribeKey:y,underive:R,watch:J});function y(r,n,e,t){return O(r,s=>{s.some(o=>o[1][0]===n)&&e(r[n])},t)}let E;function J(r,n){const e=new Set,t=new Set;let s=!0;const o=()=>{e.forEach(c=>{c()}),e.clear(),t.clear()},f=()=>{if(!s)return;o();const c=E;E=e;try{const a=r(l=>(t.add(l),l));a&&e.add(a)}finally{E=c}t.forEach(a=>{const l=O(a,f,n==null?void 0:n.sync);e.add(l)})},i=()=>{s&&(o(),s=!1)};return E&&E.add(i),f(),i}const T=Symbol();function H(r,n){let e;try{e=window.__REDUX_DEVTOOLS_EXTENSION__}catch{}if(!e)return;let t=!1;const s=e.connect({name:n}),o=O(r,i=>{const c=i.filter(([a,l])=>l[0]!==T).map(([a,l])=>`${a}:${l.map(String).join(".")}`).join(", ");if(!!c)if(t)t=!1;else{const a=Object.assign({},p(r));delete a[T],s.send({type:c,updatedAt:new Date().toLocaleString()},a)}}),f=s.subscribe(i=>{var c,a,l,u,S,d;if(i.type==="ACTION"&&i.payload)try{Object.assign(r,JSON.parse(i.payload))}catch(h){console.error(`please dispatch a serializable value that JSON.parse() and proxy() support
`,h)}if(i.type==="DISPATCH"&&i.state){if(((c=i.payload)==null?void 0:c.type)==="JUMP_TO_ACTION"||((a=i.payload)==null?void 0:a.type)==="JUMP_TO_STATE"){t=!0;const h=JSON.parse(i.state);Object.assign(r,h)}r[T]=i}else if(i.type==="DISPATCH"&&((l=i.payload)==null?void 0:l.type)==="COMMIT")s.init(p(r));else if(i.type==="DISPATCH"&&((u=i.payload)==null?void 0:u.type)==="IMPORT_STATE"){const h=(S=i.payload.nextLiftedState)==null?void 0:S.actionsById,x=((d=i.payload.nextLiftedState)==null?void 0:d.computedStates)||[];t=!0,x.forEach(({state:m},w)=>{const $=h[w]||"No action found";Object.assign(r,m),w===0?s.init(p(r)):s.send($,p(r))})}});return s.init(p(r)),()=>{o(),f()}}const b=new WeakMap,g=new WeakMap,A=r=>{const n=b.get(r);n&&(n[0].forEach(e=>{const{d:t}=e;r!==t&&A(t)}),++n[2])},z=(r,n)=>{const e=b.get(r);return(e==null?void 0:e[2])?(e[3].add(n),!0):!1},_=r=>{const n=b.get(r);if(n){if(--n[2],!n[2]){const e=new Set(n[3]);n[3].clear(),e.forEach(t=>t())}n[0].forEach(e=>{const{d:t}=e;r!==t&&_(t)})}},I=r=>{const{s:n,d:e}=r;let t=g.get(e);t||(t=[new Set],g.set(r.d,t)),t[0].add(r);let s=b.get(n);if(!s){const o=new Set,f=O(n,i=>{o.forEach(c=>{const{d:a,c:l,n:u,i:S}=c;n===a&&i.every(d=>d[1].length===1&&S.includes(d[1][0]))||c.p||(A(n),u?(l(),_(n)):c.p=Promise.resolve().then(()=>{delete c.p,l(),_(n)}))})},!0);s=[o,f,0,new Set],b.set(n,s)}s[0].add(r)},P=r=>{const{s:n,d:e}=r,t=g.get(e);t==null||t[0].delete(r),(t==null?void 0:t[0].size)===0&&g.delete(e);const s=b.get(n);if(s){const[o,f]=s;o.delete(r),o.size||(f(),b.delete(n))}},N=r=>{const n=g.get(r);return n?Array.from(n[0]):[]},B=C("unstable_deriveSubscriptions",{add:I,remove:P,list:N});function W(r,n){const e=(n==null?void 0:n.proxy)||v({}),t=!!(n==null?void 0:n.sync),s=Object.keys(r);return s.forEach(o=>{if(Object.getOwnPropertyDescriptor(e,o))throw new Error("object property already defined");const f=r[o];let i=null;const c=()=>{if(i&&(Array.from(i).map(([d])=>z(d,c)).some(d=>d)||Array.from(i).every(([d,h])=>j(d)===h.v)))return;const a=new Map,u=f(d=>(a.set(d,{v:j(d)}),d)),S=()=>{a.forEach((d,h)=>{var x;const m=(x=i==null?void 0:i.get(h))==null?void 0:x.s;if(m)d.s=m;else{const w={s:h,d:e,k:o,c,n:t,i:s};I(w),d.s=w}}),i==null||i.forEach((d,h)=>{!a.has(h)&&d.s&&P(d.s)}),i=a};u instanceof Promise?u.finally(S):S(),e[o]=u};c()}),e}function R(r,n){const e=(n==null?void 0:n.delete)?new Set:null;N(r).forEach(t=>{const{k:s}=t;(!(n==null?void 0:n.keys)||n.keys.includes(s))&&(P(t),e&&e.add(s))}),e&&e.forEach(t=>{delete r[t]})}function L(r,n,e=r){console.warn("addComputed is deprecated. Please consider using `derive` or `proxyWithComputed` instead. Falling back to emulation with derive.");const t={};return Object.keys(n).forEach(s=>{t[s]=o=>n[s](o(r))}),W(t,{proxy:e})}function U(r,n){Object.keys(n).forEach(t=>{if(Object.getOwnPropertyDescriptor(r,t))throw new Error("object property already defined");const s=n[t],{get:o,set:f}=typeof s=="function"?{get:s}:s;let i,c,a=new WeakMap;const l={};l.get=()=>{const u=p(e);return(!c||k(c,u,a))&&(a=new WeakMap,i=o(D(u,a)),c=u),i},f&&(l.set=u=>f(e,u)),Object.defineProperty(r,t,l)});const e=v(r);return e}function V(r,n=!1){const e=v({value:r,history:M({wip:r,snapshots:[],index:-1}),canUndo:()=>e.history.index>0,undo:()=>{e.canUndo()&&(e.value=e.history.wip=e.history.snapshots[--e.history.index],e.history.snapshots[e.history.index]=p(e).value)},canRedo:()=>e.history.index<e.history.snapshots.length-1,redo:()=>{e.canRedo()&&(e.value=e.history.wip=e.history.snapshots[++e.history.index],e.history.snapshots[e.history.index]=p(e).value)},saveHistory:()=>{e.history.snapshots.splice(e.history.index+1),e.history.snapshots.push(p(e).value),++e.history.index},subscribe:()=>O(e,t=>{t.every(s=>s[1][0]==="value"&&(s[0]!=="set"||s[2]!==e.history.wip))&&e.saveHistory()})});return e.saveHistory(),n||e.subscribe(),e}function K(r){const n=v({data:Array.from(new Set(r)),has(e){return this.data.indexOf(e)!==-1},add(e){let t=!1;return typeof e=="object"&&e!==null&&(t=this.data.indexOf(v(e))!==-1),this.data.indexOf(e)===-1&&!t&&this.data.push(e),this},delete(e){const t=this.data.indexOf(e);return t===-1?!1:(this.data.splice(t,1),!0)},clear(){this.data.splice(0)},get size(){return this.data.length},forEach(e){this.data.forEach(t=>{e(t,t,this)})},get[Symbol.toStringTag](){return"Set"},toJSON(){return{}},[Symbol.iterator](){return this.data[Symbol.iterator]()},values(){return this.data.values()},keys(){return this.data.values()},entries(){return new Set(this.data).entries()}});return Object.defineProperties(n,{data:{enumerable:!1},size:{enumerable:!1},toJSON:{enumerable:!1}}),Object.seal(n),n}function X(r){const n=v({data:Array.from(r||[]),has(e){return this.data.some(t=>t[0]===e)},set(e,t){const s=this.data.find(o=>o[0]===e);return s?s[1]=t:this.data.push([e,t]),this},get(e){var t;return(t=this.data.find(s=>s[0]===e))==null?void 0:t[1]},delete(e){const t=this.data.findIndex(s=>s[0]===e);return t===-1?!1:(this.data.splice(t,1),!0)},clear(){this.data.splice(0)},get size(){return this.data.length},toJSON(){return{}},forEach(e){this.data.forEach(t=>{e(t[1],t[0],this)})},keys(){return this.data.map(e=>e[0]).values()},values(){return this.data.map(e=>e[1]).values()},entries(){return new Map(this.data).entries()},get[Symbol.toStringTag](){return"Map"},[Symbol.iterator](){return this.entries()}});return Object.defineProperties(n,{data:{enumerable:!1},size:{enumerable:!1},toJSON:{enumerable:!1}}),Object.seal(n),n}}}});
